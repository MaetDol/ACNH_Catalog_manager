<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>아이템 데이터 삽입 페이지</title>
</head>
<body>
    <form action="/admin/item/inesrt" method="POST">
        <div id="item">
            <header>
                <h2>아이템</h2>
                <div class="column">
                    <span>아이디</span>
                    <span>한글 이름</span>
                    <span>영어 명</span>
                </div>
            </header>
            <input type="text" name="id">
            <input type="text" name="name_kr">
            <input type="text" name="name_en">
        </div>

        <div id="variants">
            <header>
                <h2>변형</h2>
                <div class="column">
                    <span>한글 색상명</span>
                    <span>영어 색상명</span>
                    <span>파일 이름</span>
                </div>
            </header>
            <ol>
                <li data-type="variants">
                    <input type="text" data-property="color_kr" name="variants[0].color_kr">
                    <input type="text" data-property="color_en" name="variants[0].color_en">
                    <input type="text" data-property="file_id" name="variants[0].file_id">
                </li>
            </ol>
            <button id="add-variant" type="button">추가</button>
        </div>
        
        <div id="tags">
            <header>
                <h2>태그</h2>
                <div class="column">
                    <span>태그 종류</span>
                </div>
            </header>
            <ol>
                <li data-type="tags">
                    <input type="text" data-property="id" name="tags[0].id">
                </li>
            </ol>
            <button id="add-tag" type="button">추가</button>
        </div>

        <button type="button">등록</button>
    </form>
    
    <template id="variant-template" data-count="1">
        <li data-type="variants">
            <input type="text" data-property="color_kr">
            <input type="text" data-property="color_en">
            <input type="text" data-property="file_id">
        </li>
    </template>

    <template id="tag-template" data-count="1">
        <li data-type="tags">
            <input type="text" data-property="id">
        </li>
    </template>

    <script src="js/frame.js"></script>
    <script>
        const createTagButton = document.find('#add-tag');
        const createVariantbutotn = document.find('#add-variant');

        createTagButton.addEventListener('click', _=> {
            const node = cloneTemplate('tag-template');
            document.find('#tags ol').append( node );
        });
        createVariantbutotn.addEventListener('click', _=> {
            const node = cloneTemplate('variant-template');
            document.find('#variants ol').append( node );
        });

        function cloneTemplate( id ) {
            const template = document.find('#' + id );
            let nodeCount = Number( template.dataset.count );
            
            const node = template.content.cloneNode( true ).find('li');
            const type = node.dataset.type;
            const properties = node.children;
            for( const prop of properties ) {
                const name = prop.dataset.property;
                prop.name = `${type}[${nodeCount}].${name}`;
            }
            template.dataset.count = nodeCount +1;
            return node;
        }
    </script>
</body>
</html>